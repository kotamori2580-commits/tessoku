/**
 * 難易度（体感）：★★☆☆☆
 * 結果：AC
 * 解法：優先度付キュー
 * * 【学んだこと・ポイント】
 * ・小さい順に取り出すときは、priority_queue<int, vector<int>, greater<int>> と宣言する
 * * 【反省・詰まった点】
 * ・
 * * 【計算量】
 * ・O(Q log Q)
 */
#include <bits/stdc++.h>
using namespace std;

int main(){
  int Q;
  cin >> Q;
  priority_queue<int, vector<int>, greater<int>> pq;
  for(int i=0;i<Q;i++){
    int x;
    cin >>x;
    if(x==1){
      int a;
      cin >>a;
      pq.push(a);
    }
    else if(x==2){
      int ans;
      ans = pq.top();
      cout << ans << "\n";
    }
    else{
      pq.pop();
    }
  }
}
